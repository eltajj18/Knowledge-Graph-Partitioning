import numpy as np
import pandas as pd


# Raw data string (replace this with reading from file if needed)
data_string = """
3247,2375,1815,4344,249557,156,98,3160,2580,9632,7250,3623,1140003,1389573,10266,1626,18186,143,241,50507,48,57,3157,2047,810,1105322,10379,13664,2355,2384,5278,22369,114,1925,70365,6942,492,8956,212,155,1229,2043,32,51166,3994,2092,11762,3176,771,53770,50189,17987,18006
1296,1673,1756,3707,202922,207,95,2480,2451,687,1885,324,1155070,865470,6554,1206,16326,170,206,41361,56,46,1156,954,717,689073,10854,13487,2053,2379,4987,21140,92,1122,34607,7075,118,8369,109,135,1219,2020,26,26679,2617,1463,4301,3000,752,20830,33667,17962,17965
911,960,1717,3332,199718,287,42,2416,1808,829,1921,322,1136312,909118,7017,1272,8447,106,117,41157,39,31,1293,627,656,666281,7549,11418,1847,2229,4699,21138,69,806,35458,6974,510,8816,94,125,1173,2017,26,25489,2654,1465,3423,2983,747,18206,31597,17934,18012
1143,748,1729,3414,197654,137,41,2609,1349,986,1889,304,841374,1077495,7297,1344,9483,104,198,41592,41,34,1178,918,641,748058,8596,12402,1733,2273,4683,21447,67,778,34829,7058,393,8283,145,128,1290,2014,27,26008,2692,1468,4282,2935,741,18618,32088,17942,17954
615,674,1743,3130,176535,215,42,2475,928,944,1938,306,723189,644109,4314,1041,7868,108,65,40094,37,53,829,1109,634,590451,6595,11097,1746,2237,4385,21218,122,590,25423,6892,326,7845,153,128,1242,2021,27,24344,2843,1467,2284,2851,752,10281,25010,17978,17982
734,417,1754,3243,171576,220,40,2373,821,768,1923,308,614474,590534,3954,1101,7269,106,101,40103,49,42,901,278,634,546995,6098,9322,1526,2155,4179,20853,66,471,24605,6900,307,7517,120,130,1231,2037,26,22813,2510,1467,1628,2907,740,7273,23236,17933,17966
370,382,1738,3004,169944,235,41,2397,713,409,1951,312,592247,573046,3631,1026,6980,104,96,39628,50,49,895,481,633,534689,5102,8920,1552,2140,4134,21141,69,564,21895,6890,170,7791,115,129,1223,2014,26,22486,2561,1472,1283,2835,740,7346,22674,17961,18048
393,418,1736,2909,169069,220,42,2414,716,555,1933,384,578233,566685,3593,1046,6878,110,124,39335,46,51,1036,388,645,535548,5623,8999,1439,2099,4210,21086,68,515,22894,6909,118,7377,119,129,1191,2047,30,23030,2546,1468,1350,2845,760,8138,23270,17953,18011
506,397,1708,2957,169118,185,41,2446,874,461,1982,306,569205,558668,3470,1011,7771,118,63,39376,48,40,801,553,661,529904,7449,10173,1611,2173,4032,21356,186,572,23021,6872,193,7350,114,128,1151,2055,26,23310,2602,1486,1470,2878,792,7663,22231,17930,17960
408,340,1713,3017,167999,163,43,2437,775,569,1935,338,581666,561525,3946,992,7838,114,112,38923,40,55,888,628,701,532421,6103,9126,1531,2156,4152,21090,67,451,21858,6925,312,7376,170,131,1242,2046,28,23425,2542,1471,1298,2863,767,6782,22026,17862,17911
"""

# Convert string to list of lists (each sublist is a row)
data_lines = [list(map(float, line.strip().split(','))) for line in data_string.strip().split('\n')]

# Convert to NumPy array for processing
data_array = np.array(data_lines)  # shape: (10, 43)
print(f"Data shape: {data_array.shape}")
# Calculate average for each column (query)
# Compute statistics
averages = np.mean(data_array, axis=0)
std_devs = np.std(data_array, axis=0)
coeff_var = std_devs / averages  # Coefficient of Variation
var = np.var(data_array, axis=0)

# Create DataFrame with results
query_ids = [f"query_{i+1}" for i in range(data_array.shape[1])]
df = pd.DataFrame({
    'category': query_ids,
    'average_time': averages,
    'std_dev': std_devs,
    'CV': coeff_var
})



# Format CV as a percentage (optional)
df['CV'] = df['CV'].round(2)  # round to 2 decimal places

# Output the table
print(df.to_string(index=False))

average_variance = np.mean(var)
average_std_from_var = np.sqrt(average_variance)
print(f"\nAverage standard deviation (via mean of variances): {average_std_from_var:.4f}")

#print("\nCoefficient of Variation (CV):")
#print(coeff_var)

