import numpy as np
import pandas as pd

# Raw data string (replace this with reading from file if needed)
data_string = """
3587,1447,1784,3761,384734,247,156,3243,2010,8697,6218,3663,1500685,1378367,40158,1952,216711,277,808,58472,77,124,3457,4893,778,1000162,150310,17099,1511,6811,6272,36762,807,836,142073,8938,1087,17083,783,261,1666,2520,54,48491,5042,3079,7463,5958,582,110744,5361,552,587
796,984,2003,3476,358463,227,112,2503,745,527,3320,2176,858251,800620,11642,1380,90350,1797,3032,48417,78,67,1954,1747,798,672656,97302,14160,1532,6262,4802,29334,133,896,96942,8824,513,14482,542,274,1241,2349,74,40010,4331,1916,2734,5004,452,79542,2027,560,561
391,818,3877,4501,363816,203,308,2631,1600,273,3036,792,963225,1084288,23046,1984,225723,243,687,48335,81,66,1591,3098,746,902360,123926,16647,1415,3460,5018,23944,933,636,164907,8556,1559,42413,22641,149,1154,2318,28,240410,11019,2069,7599,4066,359,241235,4344,285,524
301,1090,1759,3438,351769,219,109,2511,680,1456,2423,2068,861317,912706,17224,1220,156113,193,466,52297,144,66,3219,3653,766,747035,109415,17542,1335,7246,5791,26095,120,1149,97502,8611,337,16552,614,257,1158,2129,26,45284,4743,1606,3476,4734,453,83230,1909,455,300
592,493,1720,3177,356105,248,135,2731,774,895,3247,887,703811,863037,19849,3218,111227,373,762,46717,78,54,2889,2235,756,718333,83797,15770,1173,6228,5515,26630,129,755,94171,8535,548,13207,1237,244,1166,2375,58,40802,3901,1843,2925,4591,441,93836,3800,452,544
1859,1305,1726,3349,328108,202,119,2519,700,819,2773,1638,731603,905005,33439,4222,187083,303,1304,51099,100,124,7318,2584,692,1069526,106300,23038,1135,6656,4147,20738,144,2055,131639,8590,427,18738,1672,126,1436,2371,67,52529,4700,1327,5208,3678,432,96685,2851,318,528
354,1700,1730,3209,334867,196,349,2476,459,548,2197,1159,658166,871651,34456,1070,157025,309,1168,57184,121,44,5879,2498,755,1735893,354824,49186,1147,4642,11518,17323,119,354,329301,8200,6991,25394,1064,134,4240,2330,81,64275,6424,2158,5486,4034,438,108330,2681,265,859
573,765,1862,4086,189894,142,83,2226,250,689,2907,1335,635217,738724,14068,1423,73291,561,247,54020,168,172,1066,2621,901,766103,49647,18874,3382,4321,6297,70564,496,1258,141830,10340,251,31054,978,379,1765,3582,187,104594,10541,3330,3899,11585,634,210086,3665,286,639
162,393,1711,2955,182602,150,117,2246,276,280,1586,646,501688,448962,4265,886,30177,115,250,38267,66,32,829,610,679,471610,25826,8953,1012,2826,3610,16525,95,312,36099,7879,68,6848,136,116,979,2020,28,18546,2281,1311,550,2622,347,39846,1107,272,270
162,361,1714,2934,181607,144,471,2223,234,296,1567,417,492474,447971,4265,966,37817,92,314,38413,45,22,762,938,683,474283,28670,8714,1009,2706,3572,24991,71,293,39708,7941,68,6960,121,114,976,1977,33,18632,2266,1391,673,2866,349,39815,1106,269,284
"""

# Convert string to list of lists (each sublist is a row)
data_lines = [list(map(float, line.strip().split(','))) for line in data_string.strip().split('\n')]

# Convert to NumPy array for processing
data_array = np.array(data_lines)  # shape: (10, 43)
print(f"Data shape: {data_array.shape}")
# Calculate average for each column (query)
# Compute statistics
averages = np.mean(data_array, axis=0)
std_devs = np.std(data_array, axis=0)
coeff_var = std_devs / averages  # Coefficient of Variation

# Create DataFrame with results
query_ids = [f"query_{i+1}" for i in range(data_array.shape[1])]
df = pd.DataFrame({
    'category': query_ids,
    'average_time': averages,
    'std_dev': std_devs,
    'CV': coeff_var
})

# Format CV as a percentage (optional)
df['CV'] = df['CV'].round(2)  # round to 2 decimal places

# Output the table
print(df.to_string(index=False))
#print("\nCoefficient of Variation (CV):")
#print(coeff_var)
